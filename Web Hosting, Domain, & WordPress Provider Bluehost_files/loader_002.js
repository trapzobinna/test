var g="2.7.0";var d=g;var l=function(){return new URLSearchParams(window.location.search).get("env")||window._snippetEnv||window._satellite?.environment?.stage||"local"}(),h={env:l,loggerLoaded:!1,loaded:!1,styles:[]},s=function(){return window._snippetMeta===void 0&&(window._snippetMeta=h),window._snippetMeta}();var b=18,v=`https://sfbff.newfold.com/static/nfd-logger-browser/${b}/nfd-logger-browser.umd.js`,y={local:"DEV",production:"PROD",development:"QA",staging:"STG"},E="[MTA-SNIPPETS]",L="MTASnippets_",u=[],f=window.crypto.randomUUID(),A=new URL(window.location.href).searchParams,o={async onLoggerLoaded(){let e=y[s.env];window.sfLogger.init("MTA-SNIPPETS",e,"MTA-SNIPPETS"),console.log(this.getLogText(`Sending ${u.length} queued logs...`)),u.forEach(({event:t,level:n})=>{this.sendEvent(t,n)})},async load(){if(s.loggerLoaded)return!0;s.loggerLoaded=!0,window.addEventListener("loggerLoaded",this.onLoggerLoaded.bind(this));let e=await fetch(v),t=document.createElement("script");t.innerText=await e.text(),document.querySelector("head")?.append(t),this.debug(`Logger trace: ${f}`)},isLoggable(){let e=s.env;return["production","staging"].includes(e)},getLogText(e){return`${E} (${new Date().toLocaleTimeString()}): ${e}`},getEventType(e){return L+e},sendEvent(e,t){this.isLoggable()&&window.sfLogger[t](e)},logEvent(e,t){window.sfLogger===void 0?u.push({event:e,level:t}):this.sendEvent(e,t)},getLogMetaInfo(){return{appVersion:d,trace:f,userAgent:navigator.userAgent,hostname:window.location.hostname}},error(e){let{eventType:t,message:n,error:r,customAttributes:i}=e,a=this.getLogText(n),c={message:n??"Error during the execution of the service",eventType:this.getEventType(t??"Error"),customAttributes:{errorName:r?.name,errorMessage:r?.message,errorStack:r?.stack,...this.getLogMetaInfo(),...i}};this.logEvent(c,"error"),r?console.error(`${a}

`,r):console.error(a)},info(e){let{eventType:t,message:n,customAttributes:r}=e,i=this.getLogText(n),a={message:n??"Info logged",eventType:this.getEventType(t??"Log"),customAttributes:{...this.getLogMetaInfo(),...r}};this.logEvent(a,"info"),console.log(i)},debug(e){if(!(A.get("debug")==="true"))return;let n=this.getLogText(`(DEBUG) ${e}`);console.log(n)},warn(e,t){let n=this.getLogText(e);console.warn(n,t)},infoPerformance(e){let{label:t,callback:n,customAttributes:r}=e,i=performance.now();n();let a=performance.now(),c=Math.round(a-i);o.debug(`Execution time ${c}ms`)}};function p(e){return new URL(`/snippets${e}`,import.meta.url).toString()}var w=new URL(import.meta.url).searchParams,T=w.get("snippet");s.loaded||(o.debug(`Running on version ${d}`),o.debug(`Using '${l}' environment`),s.loaded=!0);function x(e){o.infoPerformance({label:"LoadTime",callback:async()=>{(await import(e)).load()},customAttributes:{url:e}})}function S(){let e=T,t=p(e);o.debug(`Initializing: "${e}"`),o.load();try{x(t),o.debug(`Successfully loaded '${e}'`)}catch(n){o.error({message:`unable to load '${e}'`,eventType:"LoaderError",error:n})}}S();
//# sourceMappingURL=loader.js.map
